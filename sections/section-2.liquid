{% assign anc_id = section.id | split: '_' | last %}

<div class="ctcs" data-section-id="{{ anc_id }}">
  <style>
    .ctcs .ctc-wrapper {
      margin: 0 auto;
      max-width: {{ section.settings.section_max_width | default: 1116 }}px;
      padding: 24px;
      box-sizing: border-box;
    }

    .ctc-columns {
      display: flex;
      gap: 24px;
      align-items: start;
    }

    .ctc-left .heading-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 16px;
      width: 100%;
    }

    .ctc-heading {
      margin: 0;
      line-height: 1.1;
      color: {{ section.settings.heading_color }};
      font-weight: {{ section.settings.heading_font_weight }};
      font-size: {{ section.settings.heading_desktop_font_size | default: 36 }}px;
    }

    .ctc-image {
      width: {{ section.settings.image_desktop_width | default: 240 }}px;
      height: {{ section.settings.image_desktop_width | default: 240 }}px;
      flex-shrink: 0;
      object-fit: cover;
      border-radius: 6px;
    }

    .ctc-subrich {
      margin-top: 25px;
      color: #333;
      margin-bottom: 33px;
    }

    .ctc-belowrich.rte {
      margin-top: 35px;
      margin-bottom: 20px;
      max-width: 212px;
      font-size: 18px;
      font-weight: 500;
      color: rgba(51, 51, 51, 1);
    }

    .ctc-list {
      margin-top: 16px;
      padding: 0;
      list-style: none;
    }

    .ctc-list li {
      display: flex;
      align-items: center;
      gap: 12px;
      margin: 10px 0;
      font-size: 17px;
      line-height: 30px;
    }

    .ctc-list .li-svg {
      width: 15px;
      height: 12px;
      flex: 0 0 15px;
      margin-top: 4px;
    }

    .ctc-center-container {
      margin-top: 18px;
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      gap: 12px;
    }

    .ctc-strike {
      text-decoration: line-through;
      color: rgba(192, 192, 192, 1);
      font-size: 18px;
    }

    .ctc-price {
      font-size: 30px;
      font-weight: 600;
      color: rgba(193, 155, 97, 1);
    }

    .ctc-order-btn {
      display: inline-block;
      max-width: 360px;
      width: 100%;
      padding: 19px 23px;
      text-align: center;
      text-decoration: none;
      border-radius: 8px;
      background: rgba(193, 155, 97, 1);
      color: #fff;
      font-weight: 600;
      font-size: 22px;
      transition: all 0.3s ease;
      border: 1px solid rgba(238, 238, 238, 1);
    }

    .ctc-order-btn:hover {
      border-color: rgba(193, 155, 97, 1);
      background: transparent;
      color: rgba(193, 155, 97, 1);
    }

    .ctc-right {
      position: relative;
    }

    .ctc-arrows {
      position: absolute;
      top: 8px;
      left: 8px;
      z-index: 20;
      display: flex;
      gap: 14px;
    }

    .ctc-arrow-btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 10px;
      width: 44px;
      height: 44px;
      border-radius: 100px;
      background: transparent;
      border: none;
      cursor: pointer;
    }

    .ctc-arrow-btn svg path {
      fill: #c19b61;
    }

    .ctc-swiper-wrap {
      display: grid;
      grid-template-columns: 1fr 80px;
      gap: 12px;
      width: 100%;
      overflow: hidden;
      align-items: start;
    }

    .ctc-main-swiper {
      display: block;
      position: relative;
      width: 100%;
      overflow: hidden;
    }

    .ctc-left {
      width: calc(40% - 12px);
    }

    .ctc-right {
      flex: 1;
      width: calc(60% - 12px);
    }

    .ctc-main-swiper .swiper-slide img,
    .ctc-thumb-swiper .swiper-slide img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 6px;
      display: block;
    }

    .ctc-thumb-swiper {
      width: 80px;
      height: 100%;
      max-height: 500px;
      overflow: hidden;
      position: relative;
    }

    .ctc-thumb-swiper .swiper-wrapper {
      display: flex;
      flex-direction: column;
      height: auto !important;
    }

    .ctc-thumb-swiper .swiper-slide {
      height: 80px !important;
      flex-shrink: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      opacity: 0.9;
      cursor: pointer;
    }

    .ctc-thumb-swiper .swiper-slide-thumb-active {
      opacity: 1;
      border: 2px solid #b87664;
      box-sizing: border-box;
    }

    .ctc-features {
      margin-top: 14px;
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 5px;
      column-gap: 100px;
    }

    .feature-text {
      font-size: 17px;
    }

    .ctc-feature-item {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 4px 8px;
    }

    .ctc-feature-item img {
      width: 34px;
      height: 34px;
      object-fit: contain;
      object-position: center center;
      flex-shrink: 0;
      border-radius: 4px;
    }

    .ctc-subrich p {
      font-size: 17px;
      text-align: center;
    }

    .c-sold {
      font-weight: 600;
      font-size: 35px;
      text-align: center;
    }

    @media (max-width: 767px) {
      .ctcs .ctc-wrapper {
        padding: 16px;
      }

      .ctc-columns {
        display: block;
      }

      .ctc-image {
        width: {{ section.settings.image_mobile_width | default: 200 }}px;
        height: {{ section.settings.image_mobile_width | default: 200 }}px;
      }

      .ctc-left .heading-row {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
      }

      .ctc-heading {
        font-size: {{ section.settings.heading_mobile_font_size | default: 22 }}px;
        text-align: center;
      }

      .ctc-subrich,
      .ctc-belowrich {
        text-align: center;
        max-width: 328px;
        margin-left: auto;
        margin-right: auto;
      }

      .ctc-swiper-wrap,
      .ctc-arrows {
        display: none;
      }

      .ctc-features {
        display: grid;
        grid-template-columns: 1fr;
      }

      a.ctc-order-btn {
        max-width: 100%;
      }

      .ctc-left,
      .ctc-right {
        flex: 1;
        width: 100%;
      }
    }
  </style>

  <div class="ctc-wrapper">
    <div class="ctc-columns">
      <div class="ctc-left">
        <div class="heading-row">
          <h2 class="ctc-heading">{{ section.settings.heading }}</h2>
          {% if section.settings.left_image != blank %}
            <img class="ctc-image" src="{{ section.settings.left_image | img_url: 'master' }}" alt="{{ section.settings.heading | escape }}">
          {% endif %}
        </div>

        {% if section.settings.sub_richtext != blank %}
          <div class="ctc-subrich rte">{{ section.settings.sub_richtext }}</div>
        {% endif %}

        {% assign lists = section.blocks | where: "type", "list_item" %}
        {% if lists.size > 0 %}
          <ul class="ctc-list">
            {% for block in lists %}
              <li id="block-{{ block.id }}">
                <span class="li-svg">
                  <svg width="15" height="12" viewBox="0 0 15 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M13.5807 1.76562L4.41406 10.9415L1.66406 8.19146" stroke="#B87664" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </span>
                <span class="li-text">{{ block.settings.list_text }}</span>
              </li>
            {% endfor %}
          </ul>
        {% endif %}

        <div class="ctc-center-container">
          {% if section.settings.below_richtext != blank %}
            <div class="ctc-belowrich rte">{{ section.settings.below_richtext }}</div>
          {% endif %}
          {% if section.settings.strike_price != blank %}
            <div class="ctc-strike">{{ section.settings.strike_price }}</div>
          {% endif %}
          {% if section.settings.price != blank %}
            <div class="ctc-price">{{ section.settings.price }}</div>
          {% endif %}
          {% if section.settings.order_button_text != blank %}
            <a class="ctc-order-btn" href="{{ section.settings.order_button_link }}" aria-label="{{ section.settings.order_button_text }}">{{ section.settings.order_button_text }}</a>
          {% endif %}
        </div>
      </div>

      <div class="ctc-right">
        <div class="ctc-arrows" aria-hidden="true">
          <button class="ctc-arrow-btn" id="ctc-prev-{{ anc_id }}" type="button" aria-label="Prev">
            <svg class="prev-button-icon" viewBox="0 0 100 100">
              <path d="M10,50 L60,100 L70,90 L30,50 L70,10 L60,0 Z" class="arrow"></path>
            </svg>
          </button>
          <button class="ctc-arrow-btn" id="ctc-next-{{ anc_id }}" type="button" aria-label="Next">
            <svg class="next-button-icon" viewBox="0 0 100 100">
              <path d="M10,50 L60,100 L70,90 L30,50 L70,10 L60,0 Z" class="arrow" transform="translate(100,100) rotate(180)"></path>
            </svg>
          </button>
        </div>

        <div class="ctc-swiper-wrap">
          <div class="ctc-main-swiper">
            <div class="swiper swiper-container main-swiper-{{ anc_id }}">
              <div class="swiper-wrapper">
                {% for block in section.blocks %}
                  {% if block.type == 'image' %}
                    <div class="swiper-slide">
                      <img src="{{ block.settings.image | img_url: '2048x2048' }}" alt="{{ block.settings.image_alt | escape }}">
                    </div>
                  {% endif %}
                {% endfor %}
              </div>
            </div>
          </div>

          <div class="ctc-thumb-swiper">
            <div class="swiper swiper-container thumb-swiper-{{ anc_id }}">
              <div class="swiper-wrapper">
                {% for block in section.blocks %}
                  {% if block.type == 'image' %}
                    <div class="swiper-slide">
                      <img src="{{ block.settings.image | img_url: '200x200' }}" alt="{{ block.settings.image_alt | escape }}">
                    </div>
                  {% endif %}
                {% endfor %}
              </div>
            </div>
          </div>
        </div>

        <div class="ctc-features">
          {% for block in section.blocks %}
            {% if block.type == 'image_with_text' %}
              <div class="ctc-feature-item">
                {% if block.settings.feature_image != blank %}
                  <img src="{{ block.settings.feature_image | img_url: '100x100' }}" alt="{{ block.settings.feature_image_alt | escape }}">
                {% endif %}
                <div class="feature-text">{{ block.settings.feature_text }}</div>
              </div>
            {% endif %}
          {% endfor %}
        </div>
      </div>
    </div>

    {% if section.settings.sold != blank %}
      <p class="c-sold">{{ section.settings.sold }}</p>
    {% endif %}
  </div>

  <link rel="stylesheet" href="https://unpkg.com/swiper@9/swiper-bundle.min.css" />
  <script src="https://unpkg.com/swiper@9/swiper-bundle.min.js"></script>

  <script>
    (function () {
      var prevBtn = document.getElementById('ctc-prev-{{ anc_id }}');
      var nextBtn = document.getElementById('ctc-next-{{ anc_id }}');
      var mainSelector = '.main-swiper-{{ anc_id }}';
      var thumbSelector = '.thumb-swiper-{{ anc_id }}';

      function initSwiperIfNeeded() {
        var isMobile = window.matchMedia('(max-width: 767px)').matches;
        var mainContainer = document.querySelector(mainSelector + ' .swiper-wrapper');
        if (!mainContainer || mainContainer.children.length === 0) return;

        if (window['ctcMainSwiper_{{ anc_id }}']) {
          window['ctcMainSwiper_{{ anc_id }}'].destroy(true, true);
          if (window['ctcThumbSwiper_{{ anc_id }}'])
            window['ctcThumbSwiper_{{ anc_id }}'].destroy(true, true);
          window['ctcMainSwiper_{{ anc_id }}'] = null;
          window['ctcThumbSwiper_{{ anc_id }}'] = null;
        }

        if (isMobile) return;

        var thumbSwiper = new Swiper(thumbSelector, {
          direction: 'vertical',
          slidesPerView: Math.min(4, document.querySelectorAll(thumbSelector + ' .swiper-slide').length),
          spaceBetween: 8,
          watchSlidesProgress: true,
          watchSlidesVisibility: true
        });

        var mainSwiper = new Swiper(mainSelector, {
          slidesPerView: 1,
          spaceBetween: 10,
          navigation: {
            nextEl: '#ctc-next-{{ anc_id }}',
            prevEl: '#ctc-prev-{{ anc_id }}'
          },
          thumbs: { swiper: thumbSwiper }
        });

        window['ctcMainSwiper_{{ anc_id }}'] = mainSwiper;
        window['ctcThumbSwiper_{{ anc_id }}'] = thumbSwiper;

        prevBtn && prevBtn.addEventListener('click', () => mainSwiper.slidePrev());
        nextBtn && nextBtn.addEventListener('click', () => mainSwiper.slideNext());
      }

      initSwiperIfNeeded();
      var resizeTimer;
      window.addEventListener('resize', function () {
        clearTimeout(resizeTimer);
        resizeTimer = setTimeout(initSwiperIfNeeded, 150);
      });

      function applyResponsiveImageSizes() {
        var leftImg = document.querySelector('[data-section-id="{{ anc_id }}"] .ctc-left .ctc-image');
        if (!leftImg) return;
        var isMobile = window.matchMedia('(max-width: 767px)').matches;
        var width = isMobile ? {{ section.settings.image_mobile_width | default: 200 }} : {{ section.settings.image_desktop_width | default: 240 }};
        leftImg.style.width = width + 'px';
        leftImg.style.height = width + 'px';
      }

      applyResponsiveImageSizes();
      window.addEventListener('resize', applyResponsiveImageSizes);
    })();
  </script>
</div>




{% schema %}
{
  "name": "Section 2",
  "settings": [
    {
      "type": "range",
      "id": "section_max_width",
      "label": "Section max width (px)",
      "min": 600,
      "max": 1600,
      "step": 10,
      "default": 1120
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Your heading here"
    },
    {
      "type": "range",
      "id": "heading_desktop_font_size",
      "label": "Heading desktop font size (px)",
      "min": 18,
      "max": 72,
      "step": 1,
      "default": 36
    },
    {
      "type": "range",
      "id": "heading_mobile_font_size",
      "label": "Heading mobile font size (px)",
      "min": 14,
      "max": 48,
      "step": 1,
      "default": 22
    },
    {
      "type": "select",
      "id": "heading_font_weight",
      "label": "Heading font weight",
      "options": [
        { "value": "400", "label": "400" },
        { "value": "500", "label": "500" },
        { "value": "600", "label": "600" },
        { "value": "700", "label": "700" },
        { "value": "800", "label": "800" }
      ],
      "default": "700"
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Heading color",
      "default": "#111111"
    },
    {
      "type": "image_picker",
      "id": "left_image",
      "label": "Left column image (next to heading)"
    },
    {
      "type": "range",
      "id": "image_desktop_width",
      "label": "Left image desktop width (px)",
      "min": 80,
      "max": 600,
      "step": 10,
      "default": 240
    },
    {
      "type": "range",
      "id": "image_mobile_width",
      "label": "Left image mobile width (px)",
      "min": 60,
      "max": 360,
      "step": 10,
      "default": 200
    },
    {
      "type": "richtext",
      "id": "sub_richtext",
      "label": "Sub rich text (below heading-row)",
      "default": "<p>Short intro or subtitle</p>"
    },
    {
      "type": "richtext",
      "id": "below_richtext",
      "label": "Centered rich text (above prices)",
      "default": "<p>Additional description that sits above price & CTA.</p>"
    },
    {
      "type": "text",
      "id": "strike_price",
      "label": "Striked price",
      "default": "$199"
    },
    {
      "type": "text",
      "id": "price",
      "label": "Price",
      "default": "$149"
    },
    {
      "type": "text",
      "id": "order_button_text",
      "label": "Order now button text",
      "default": "Order now"
    },
    {
      "type": "url",
      "id": "order_button_link",
      "label": "Order button link"
    },{
        "type": "text",
        "id": "sold",
        "label": "below text",
        "default":"Over 100,000 sold"
    }
    
  ],
  "blocks": [
    {
      "type": "image",
      "name": "Image (for slider)",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Slide image"
        },
        {
          "type": "text",
          "id": "image_alt",
          "label": "Image alt text",
          "default": "image"
        }
      ]
    },
    {
      "type": "image_with_text",
      "name": "Image with text (feature)",
      "settings": [
        {
          "type": "image_picker",
          "id": "feature_image",
          "label": "Feature image (34x34)"
        },
        {
          "type": "text",
          "id": "feature_image_alt",
          "label": "Alt text",
          "default": "image"
        },
        {
          "type": "text",
          "id": "feature_text",
          "label": "Feature text",
          "default": "Feature label"
        }
      ]
    },
    {
      "type": "list_item",
      "name": "List item",
      "settings": [
        {
          "type": "text",
          "id": "list_text",
          "label": "Item text",
          "default": "List item text"
        }
      ]
    }
  ],
  "max_blocks": 20,
  "presets": [
    {
      "name": "Section 2"
    }
  ]
}
{% endschema %}
